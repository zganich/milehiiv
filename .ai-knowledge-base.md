# MileHiiv AI Knowledge Base

## PROJECT OVERVIEW
**MileHiiv** is a gig driver mileage reconciliation platform built as a single Next.js application.

## ARCHITECTURE
- **Type**: Single Next.js 15.5.3 app (NOT separate frontend/backend)
- **Location**: `milehiiv/` directory
- **API**: Vercel API routes (serverless functions)
- **Database**: Supabase PostgreSQL
- **Authentication**: JWT tokens
- **Deployment**: Vercel
- **UI**: React 19, TypeScript, Tailwind CSS

## CURRENT STATUS (Last Updated: January 2025)
### ‚úÖ COMPLETED SETUP:
- Project structure created in `milehiiv/`
- Package.json with all dependencies configured
- Environment template files created (`env.template.local`, `env.template.production`)
- README.md with complete documentation
- API route structure (`/api/auth/login/route.ts`, `/api/auth/register/route.ts`)
- Complete pages (home, login, register, dashboard)
- TypeScript configuration
- Tailwind CSS setup
- Authentication middleware configured
- Error and loading pages implemented
- NoSSR component for client-side rendering

### üîß NEEDS FRESH CONFIGURATION:
- New Supabase project creation and credentials
- New Vercel project setup
- New GitHub repository creation
- Environment variables configuration with new credentials

## Technology Stack

- **Frontend**: Next.js 15.5.4, TypeScript, Tailwind CSS
- **Design System**: Apple Liquid Glass inspired with modern UX best practices
- **UI Components**: Custom component library with accessibility-first design
- **Backend**: Vercel API Routes (Serverless Functions)
- **Database**: Supabase (PostgreSQL)
- **Authentication**: JWT tokens
- **PDF Processing**: pdf-parse library
- **Deployment**: Vercel (Full-Stack)

### üìÅ KEY FILES:
- `milehiiv/.env.local` - Environment configuration (EXISTS)
- `milehiiv/package.json` - Dependencies (CONFIGURED)
- `milehiiv/src/app/` - Next.js app router structure
- `README.md` - Complete project documentation
- `DESIGN-SYSTEM.md` - Apple-inspired design system
- `UX-FLOW-ANALYSIS.md` - Google-level UX flow optimization
- `src/app/upload/page.tsx` - Try-before-buy upload flow
- `src/app/onboarding/page.tsx` - Guided user onboarding
- `src/app/dashboard/page.tsx` - Core user experience

## WORKFLOW RULES
1. **ALWAYS read existing files first** before suggesting changes
2. **Check current structure** with `list_dir` or `glob_file_search`
3. **Build on existing work** - don't start from scratch
4. **Verify what's actually missing** before suggesting setup steps

## COMMON MISTAKES TO AVOID:
- ‚ùå Suggesting separate backend/frontend setup
- ‚ùå Creating files that already exist
- ‚ùå Not reading `.env.local` before suggesting environment setup
- ‚ùå Assuming project needs initial setup when it's already configured

## QUICK START COMMANDS:
```bash
cd milehiiv
npm install
npm run dev
```

## ENVIRONMENT SETUP:
Copy template files and configure with new project credentials:
```bash
cd milehiiv
cp env.template.local .env.local
cp env.template.production .env.production
# Edit both files with your new Supabase, Vercel, and other credentials
```

Template includes placeholders for:
- New Supabase project URL and credentials
- New JWT secrets for development and production
- New Vercel deployment URLs
- Fresh API keys and configuration

## DEMO ACCOUNT:
- Email: demo@milehiiv.com
- Password: demo123

## PROJECT GOALS:
- PDF mileage extraction
- Gap detection algorithm
- Trip management
- Dashboard overview
- Simple UI following "grandma test" principles

## OPTIMAL USER FLOW:
MileHiiv follows Google-level UX principles with a "try before you buy" approach:

### **Phase 1: Value Discovery**
1. **Homepage**: Immediate PDF upload (no account required)
2. **Upload Page**: Process PDF and show results instantly
3. **Results Page**: Display extracted data, gaps, and tax savings
4. **CTA**: "Save Results" ‚Üí Account creation

### **Phase 2: Onboarding**
1. **Registration**: Minimal friction with social login options
2. **Onboarding**: 4-step guided setup (welcome, profile, vehicle, ready)
3. **First Upload**: Guided first PDF upload with real data

### **Phase 3: Core Experience**
1. **Dashboard**: Upload area prominently placed
2. **Gap Alerts**: Immediate notifications for missing mileage
3. **Trip Management**: Easy access to all features
4. **Export**: Tax-ready reports and exports

### **UX Principles Applied:**
- **Try Before Buy**: Users experience value before commitment
- **Progressive Disclosure**: Features revealed as needed
- **Immediate Feedback**: Real-time processing status
- **Clear Hierarchy**: Most important actions are most prominent
- **Forgiving Design**: Easy to undo mistakes and recover

## Key Features (Planned)

### PDF Processing
- Extract mileage data from uploaded PDF documents
- Support various PDF formats and layouts
- Validate extracted data for accuracy
- Automatically create trip entries

### Gap Detection Algorithm
- **Date Gaps**: Identify missing days between trips
- **Mileage Inconsistencies**: Detect mismatched odometer readings
- **Odometer Rollover**: Handle odometer reset scenarios
- **Unusual Patterns**: Flag abnormally high daily mileage

### Trip Management
- Manual trip entry with validation
- Business vs personal mileage tracking
- Location and notes support
- Trip verification system

### Dashboard
- Comprehensive mileage statistics
- Gap visualization
- Trip history overview
- PDF upload interface

## API Endpoints (Planned)

### Authentication
- `POST /api/auth/register` - Register new user
- `POST /api/auth/login` - Login user
- `GET /api/auth/me` - Get current user
- `PUT /api/auth/profile` - Update user profile

### Mileage Management
- `GET /api/mileage/trips` - Get user trips
- `POST /api/mileage/trips` - Create new trip
- `PUT /api/mileage/trips/:id` - Update trip
- `DELETE /api/mileage/trips/:id` - Delete trip
- `GET /api/mileage/summary` - Get mileage summary

### Gap Detection
- `GET /api/mileage/gaps` - Get mileage gaps
- `POST /api/mileage/gaps/detect` - Trigger gap detection
- `PUT /api/mileage/gaps/:id/resolve` - Resolve gap

### File Upload
- `POST /api/upload/pdf` - Upload and process PDF
- `GET /api/upload/files` - Get uploaded files
- `DELETE /api/upload/files/:filename` - Delete file

## Environment Configuration

### Required Environment Variables
```env
# Database Configuration (Supabase)
DATABASE_URL=postgresql://postgres:[password]@db.[project].supabase.co:5432/postgres

# Authentication
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
JWT_EXPIRES_IN=7d

# File Upload
MAX_FILE_SIZE=10485760

# App URLs
NEXT_PUBLIC_APP_URL=http://localhost:3000
NEXT_PUBLIC_API_URL=http://localhost:3000

# Supabase Configuration
NEXT_PUBLIC_SUPABASE_URL=https://[project].supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-supabase-anon-key
```

## Development Guidelines

- Follow "grandma test" principles for extreme simplicity in UI/UX
- Use Apple's Liquid Glass design language for premium feel
- Implement WCAG 2.1 AA accessibility standards
- Use TypeScript for type safety
- Follow RESTful API conventions
- Implement proper error handling and logging
- Use custom design system components (see DESIGN-SYSTEM.md)
- Follow Next.js App Router best practices
- Include micro-interactions and smooth animations
- Support dark mode and reduced motion preferences

## Demo Account
- Email: demo@milehiiv.com
- Password: demo123

## Quick Start Commands
```bash
cd milehiiv
npm install
npm run dev
```

## Design System

MileHiiv uses a world-class design system inspired by Apple's Liquid Glass design language and the latest UI/UX best practices from top tech companies. Key features include:

- **Apple Liquid Glass**: Translucent elements with backdrop blur effects
- **Micro-interactions**: Subtle animations and hover effects
- **Accessibility**: WCAG 2.1 AA compliance with screen reader support
- **Responsive Design**: Mobile-first approach with 8px grid system
- **Dark Mode**: Automatic theme switching with proper contrast
- **Typography**: Apple San Francisco inspired font stack
- **Components**: Reusable UI components with consistent styling

See `DESIGN-SYSTEM.md` for complete documentation and examples.

## Last Updated
January 2025 - MileHiiv Project Knowledge Base with Apple-inspired Design System

